<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="leaflet.css" />
    
    <script src="leaflet.js"></script>
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org/face/bebasneueregular" type="text/css" />
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

    <section class="header">
        <div id="header-e1">
            <div class="dropdown">
                <button class="dropbtn">Language
                    <i class="fa fa-caret-down"></i>
                </button>
                <div class="dropdown-content">
                    <a href="#">Telugu</a>
                    <a href="#">Hindi</a>
                    <a href="#">English</a>
                </div>
            </div>
        </div>
        <div id="header-e3">

            <a class="active" href="#home">Home</a>
            <a href="#about">About</a>        </div>
           
        </div>
        <div id="header-e2">
            COVID-19 Test Center Finder        


            
        </div>
    </section>

    <table style="width:100%">
        <tr>
            <th>
                <h2>Search by State</h2>
            </th>
            <th>
            </th>
        </tr>
        <tr>
            <td>
                <table>
                    <tr>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="tg()">Telangana</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="ap()">Andhra Pradesh</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="as()">Assam</button>

                            </div>
                        </td>
                    <tr>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="bh()">Bihar</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="ch()">Chandigarh</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="cha()">Chattisgarh</button>

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="dl()">Delhi</button>

                            </div>

                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="gj()">Gujarat</button>
                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="hr()">Haryana</button>

                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>

                            <div class="dropdown">
                                <button class="dropbtn" onclick="od()">Odisha</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="pd()">Puducherry</button>

                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="dropbtn" onclick="pb()">Punjab</button>

                            </div>
                        </td>

                    </tr>
                    <td>
                        <div class="dropdown">
                            <button class="dropbtn" onclick="rj()">Rajasthan</button>

                        </div>
                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="dropbtn" onclick="tn()">Tamil Nadu</button>

                        </div>

                    </td>
                    <td>
                        <div class="dropdown">
                            <button class="dropbtn" onclick="up()">Uttar Pradesh</button>

                        </div>
                    </td>
        </tr>
        <tr>
            <td>

                <div class="dropdown">
                    <button class="dropbtn" onclick="uk()">Uttarakhand</button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="wb()">West Bengal</button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="an()">Andaman & Nicobar</button>

                </div>
            </td>

        </tr>
        <tr>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="hp()">Himachal Pradesh</button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="jk()">Jammu & Kashmir </button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="jd()">Jharkhand</button>

                </div>
            </td>
        <tr>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="kr()">Karnataka</button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="kl()">Kerala</button>

                </div>
            </td>
            <td>

                <div class="dropdown">
                    <button class="dropbtn" onclick="mh()">Maharashtra</button>

                </div>
            </td>
        <tr>
            <td>

                <div class="dropdown">
                    <button class="dropbtn" onclick="mp()">Madhya Pradesh</button>

                </div>
            </td>
            <td>

                <div class="dropdown">
                    <button class="dropbtn" onclick="mr()">Manipur</button>

                </div>
            </td>
            <td>
                <div class="dropdown">
                    <button class="dropbtn" onclick="mg()">Meghalaya</button>

                </div>
            </td>
        </tr>
    </table>
    </td>
    <td>
        <!-- map -->
        <div id='ui'>
            <button onclick="getNearestCenter()">Get Nearest Center</button>

        </div>
        <br>
        <div id="map" style="width: 600px; height: 400px;border-style: double;"></div>





    </td>
    </tr>


    </table>

    <table border="1">
        <tr>
            <th style="color: green;">Near</th>
            <th style="color: blue;">Far</th>
            <th style="color: red;">Farthest</th>
        </tr>
        <tr>
            <td id="Green"></td>

            <td id="Blue"></td>

            <td id="Red"></td>
        </tr>
    </table>
</body>
<script src="script.js"></script>
<script src="healthCenters.js"></script>
<script>
    const map = L.map('map', {
        center: [17.387140, 78.491684],
        zoom: 15,
        scrollWheelZoom: true,
    });

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    const healthCenters = coords;
    var markerIcon = L.icon({
        iconUrl: 'marker.svg',
        iconSize: [25, 25], // size of the icon
    });
    for (let i = 0; i < healthCenters.length; i++) {
        const healthCenter = healthCenters[i];
        L.marker([healthCenter[1], healthCenter[2]], {
            icon: markerIcon
        }).bindPopup(healthCenter[0]).addTo(map);
    }

    function getNearestCenter() {
        const userCoOrds = [];
        navigator.geolocation.getCurrentPosition((data) => {
            userCoOrds.push(data.coords.latitude, data.coords.longitude);
            L.marker(userCoOrds, {
                    icon: markerIcon
                })
                .bindPopup("Your Location")
                .addTo(map);
            map.setView(userCoOrds, 9);
            // Calculate distances
            let distances = [];
            for (let i = 0; i < healthCenters.length; i++) {
                const healthCenter = healthCenters[i];
                const healthCenterLat = healthCenter[1];
                const healthCenterLon = healthCenter[2];
                const userCoOrdLat = userCoOrds[0];
                const userCoOrdLon = userCoOrds[1];
                const x = Math.abs(healthCenterLat - userCoOrdLat);
                const y = Math.abs(healthCenterLon - userCoOrdLon);
                const distance = Math.sqrt(x * x + y * y);
                distances.push([healthCenter, distance]);
            }
            const nearestValuesInOrder = distances.sort((a, b) => {
                return a[1] - b[1];
            });
            const polyline1 = L.polyline(
                [
                    userCoOrds,
                    [nearestValuesInOrder[0][0][1], nearestValuesInOrder[0][0][2]],
                ], {
                    color: "green"
                }
            ).addTo(map);
            document.getElementById("Blue").innerHTML =
                nearestValuesInOrder[1][0][0];
            const polyline2 = L.polyline(
                [
                    userCoOrds,
                    [nearestValuesInOrder[1][0][1], nearestValuesInOrder[1][0][2]],
                ], {
                    color: "blue"
                }
            ).addTo(map);
            document.getElementById("Green").innerHTML =
                nearestValuesInOrder[0][0][0];
            const polyline3 = L.polyline(
                [
                    userCoOrds,
                    [nearestValuesInOrder[2][0][1], nearestValuesInOrder[2][0][2]],
                ], {
                    color: "red"
                }
            ).addTo(map);
            document.getElementById("Red").innerHTML =
                nearestValuesInOrder[2][0][0];
            map.fitBounds(polyline3.getBounds());
            polyline3
                .bindTooltip(nearestValuesInOrder[2][0][0], {
                    permanent: true,
                    offset: [0, 12],
                })
                .addTo(map);
            polyline2
                .bindTooltip(nearestValuesInOrder[0][0][0], {
                    permanent: true,
                    offset: [0, 12],
                })
                .addTo(map);
            polyline1
                .bindTooltip(nearestValuesInOrder[1][0][0], {
                    permanent: true,
                    offset: [0, 12],
                })
                .addTo(map);
        });
    }


</script>

</html>